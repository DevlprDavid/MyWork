This is chapter 2 and this is slightly improved version